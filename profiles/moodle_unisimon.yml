# Perfil específico para Unisimon Aula Pregrado (Moodle)
metadata:
  name: "Moodle Unisimon"
  version: "1.0.0"
  description: "Perfil para aulapregrado.unisimon.edu.co"
  lms_type: "moodle"

auth:
  login_path: "/login/"
  form_selectors:
    username: "#username"
    password: "#password"
    submit: "#loginbtn"
  success_indicators:
    - url_contains: "/my/"
    - element_present: "[data-region='courses-view']"
  error_indicators:
    - element_present: ".loginerrors"

navigation:
  courses_page: "/my/courses.php"
  dashboard: "/my/"

# Vista de paneles/tarjetas en /my/courses.php (Moodle 4 block_myoverview)
# Estructura: data-region="courses-view" -> card-deck -> course-content por tarjeta
courses:
  container: "[data-region='courses-view']"
  selectors:
    - "[data-region='course-content'] a.aalink.coursename"
    - "[data-region='course-content'] a[href*='course/view.php']"
    - ".course-card a[href*='course/view.php']"
    - ".card-grid a[href*='course/view.php']"
    - "a[href*='course/view.php']"
  extract:
    name: "text"
    url: "href"

# Discovery por contenido: si no se encuentran cursos, visitar enlaces y clasificar con LLM
course_discovery:
  fallback_when_empty: true
  max_candidates: 25
  candidate_patterns:
    - "course/view.php"
    - "/course/"

assignments:
  types:
    - name: "assignment"
      selectors:
        - "a[href*='mod/assign']"
        - ".activity-assign a"
        - ".modtype_assign a"
    - name: "quiz"
      selectors:
        - "a[href*='mod/quiz']"
        - ".activity-quiz a"
    - name: "forum"
      selectors:
        - "a[href*='mod/forum']"
        - ".activity-forum a"
    - name: "workshop"
      selectors:
        - "a[href*='mod/workshop']"

dates:
  locale: "es"
  formats:
    - "%d/%m/%Y"
    - "%d-%m-%Y"
    - "%d de %B de %Y"
  selectors:
    - ".due-date"
    - ".deadline"
    - ".activity-dates"
  patterns:
    - "vencimiento.*?(\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4})"
    - "entrega.*?(\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4})"
    - "(\\d{1,2} de \\w+ de \\d{4})"

submission:
  status_table: "table.generaltable"
  indicators:
    submitted:
      - "enviado para calificar"
      - "submitted for grading"
      - "entregado"
    pending:
      - "no entregado"
      - "not submitted"
      - "pendiente"

sections:
  tab_selectors:
    - ".nav-tabs a"
    - ".course-tabs a"
    - "a[href*='section']"
  max_tabs: 5

reports:
  title_template: "Reporte de Tareas - Unisimon"
  sections:
    - name: "submitted"
      title: "Tareas Entregadas Recientemente"
      emoji: "rocket"
    - name: "overdue"
      title: "Tareas Atrasadas"
      emoji: "warning"
    - name: "due_today"
      title: "Tareas para Hoy"
      emoji: "calendar"
    - name: "upcoming"
      title: "Próximas Tareas"
      emoji: "clock"
