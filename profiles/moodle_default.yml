# Perfil genérico para portales Moodle 4.x
metadata:
  name: "Moodle Default"
  version: "1.0.0"
  description: "Perfil genérico para portales Moodle 4.x"
  lms_type: "moodle"

auth:
  login_path: "/login/"
  form_selectors:
    username: "#username"
    password: "#password"
    submit: "#loginbtn"
  success_indicators:
    - url_contains: "/my/"
    - element_present: "[data-region='courses-view']"
  error_indicators:
    - element_present: ".loginerrors"
    - text_contains: "Invalid login"

navigation:
  courses_page: "/my/courses.php"
  dashboard: "/my/"

# Moodle 4 block_myoverview: tarjetas con data-region='course-content' o .course-card
courses:
  container: "[data-region='courses-view']"
  selectors:
    - "div.card.course-card a[href*='course/view.php']"
    - "[data-region='course-content'] a[href*='course/view.php']"
    - "[data-region='course-content'] a.aalink.coursename"
    - ".course-card a[href*='course/view.php']"
    - ".card-grid a[href*='course/view.php']"
    - "a[href*='course/view.php']"
    - ".course-title a"
    - ".course-name a"
    - ".coursebox a"
  card_selectors:
    - "[data-region='course-content']"
    - "div.card.course-card"
  name_selectors:
    - "a.coursename"
    - "span.multiline"
    - "[title]"
  link_selector: "a[href*='course/view.php']"
  link_href_pattern: "course/view"
  fallback_containers:
    - "[data-region='courses-view']"
    - ".card-deck"
    - ".course-box"
  extract:
    name: "text"
    url: "href"

assignments:
  types:
    - name: "assignment"
      selectors:
        - "a[href*='mod/assign']"
        - ".activity-assign a"
        - ".modtype_assign a"
    - name: "quiz"
      selectors:
        - "a[href*='mod/quiz']"
        - ".activity-quiz a"
    - name: "forum"
      selectors:
        - "a[href*='mod/forum']"
        - ".activity-forum a"
    - name: "workshop"
      selectors:
        - "a[href*='mod/workshop']"

dates:
  locale: "es"
  formats:
    - "%d/%m/%Y"
    - "%d-%m-%Y"
    - "%d de %B de %Y"
  selectors:
    - ".due-date"
    - ".deadline"
    - ".activity-dates"
  patterns:
    - "vencimiento.*?(\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4})"
    - "entrega.*?(\\d{1,2}[/-]\\d{1,2}[/-]\\d{2,4})"
    - "(\\d{1,2} de \\w+ de \\d{4})"

submission:
  status_table: "table.generaltable"
  indicators:
    submitted:
      - "enviado para calificar"
      - "submitted for grading"
      - "entregado"
    pending:
      - "no entregado"
      - "not submitted"
      - "pendiente"

sections:
  tab_selectors:
    - ".nav-tabs a"
    - ".course-tabs a"
    - "a[href*='section']"
  max_tabs: 5

reports:
  title_template: "Reporte de Tareas - {portal_name}"
  sections:
    - name: "submitted"
      title: "Tareas Entregadas Recientemente"
      emoji: "rocket"
    - name: "overdue"
      title: "Tareas Atrasadas"
      emoji: "warning"
    - name: "due_today"
      title: "Tareas para Hoy"
      emoji: "calendar"
    - name: "upcoming"
      title: "Próximas Tareas"
      emoji: "clock"
